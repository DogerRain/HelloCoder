---
title: ç±»åŠ è½½è¿‡ç¨‹å’ŒåŒäº²å§”æ´¾æ¨¡å‹
date: 2022-06-02 11:18:18
lock: false
permalink: /pages/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B%E5%92%8C%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%9E%8B
categories: 
  - LearnJavaToFindAJob
  - ã€ä¸­çº§ã€‘12k-26kæ¡£
  - JVMè¿›é˜¶
tags: 
  - ç±»åŠ è½½è¿‡ç¨‹
---
ä½œä¸ºJVMå±‚é¢çš„Javaé¢è¯•é¢˜ï¼Œ**ç±»åŠ è½½è¿‡ç¨‹å’ŒåŒäº²å§”æ´¾æ¨¡å‹**æ˜¯å‡ ä¹å¿…é—®çš„å†…å®¹ä¹‹ä¸€ã€‚



è¿™ç¯‡æ–‡ç« å°±æ¥èŠèŠ**ç±»åŠ è½½è¿‡ç¨‹å’ŒåŒäº²å§”æ´¾æ¨¡å‹**ã€‚



## çµ®

æˆ‘é¢è¯•æ›¾ç»ä¹Ÿä¸é‡åˆ°ä¸å°‘è¿™ä¸ªé¢˜ç›®ï¼Œç¬¬ä¸€æ¬¡è¢«é—®åˆ°æˆ‘æ˜¯æ‡µé€¼çš„ï¼Œå› ä¸ºæˆ‘ç¡®å®ä¸çŸ¥é“è¿™ä¸œè¥¿ï¼Œè€Œä¸”æˆ‘ä¹Ÿæ²¡ç”¨è¿‡ã€‚

æˆ‘è§‰å¾—è¿™ç±»é¢è¯•é¢˜è€ƒå¯Ÿçš„è¿˜æ˜¯ç¨‹åºå‘˜å¯¹Javaè™šæ‹Ÿæœºçš„æ·±å±‚æ¬¡åº•å±‚åŠŸåŠ›ã€‚

è‡³äºå®ƒåœ¨å·¥ä½œè¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰ç”¨å¾—ä¸Šï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯å¾ˆé‡è¦çš„ï¼›é‡è¦çš„æ˜¯é¢è¯•å®˜è§‰å¾—ä½ çŸ¥é“äº†ï¼Œè¯´æ˜ä½ çš„Javaåº•å­è¿˜æ˜¯å¾ˆå¥½çš„ã€‚

å…³äºè™šæ‹Ÿæœºçš„çŸ¥è¯†ï¼Œæˆ‘æ˜¯è·Ÿç€å‘¨å¿—æ˜çš„[ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹](https://union-click.jd.com/jdc?e=&p=JF8AAMUDIgZlGmsVARUGUxhTHTJWWA1FBCVbV0IUWVALHEpCAUdETlcNVQtHRRUBFQZTGFMdHUtCCUZrYFRgbj5_UlFhcR1LYF8WQm9VJ2sdQw4eN1QrWxQDEQRRHFgSAyI3VRxrQ2wSBlQaWhQHEwNWK1olAhUEVRpfEgEbBVMZUyUFEg5lQA57BxEPB0laEQYSDlYaWiUyIgRlK2sVMhE3F3UMRVcTDwAaDhVSGg9QTlITURYOBRhfFFBHDgAZCRcGGzdXGloRCw)å­¦ä¹ çš„ï¼Œä¸çŸ¥ä¸è§‰å·²ç»æ˜¯ç¬¬ä¸‰ç‰ˆäº†ï¼Œå¦‚æœä½ å¯¹ä¸€ä¸ª`.java`æ–‡ä»¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆã€å¯¹æ€§èƒ½è°ƒä¼˜ã€å¯¹åº•å±‚çŸ¥è¯†æ„Ÿå…´è¶£çš„ï¼Œæˆ‘å»ºè®®å¤§å®¶é˜…è¯»ä¸€ä¸‹ã€‚



åœ¨è¿™æœ¬ä¹¦é‡Œé¢ï¼Œä¹Ÿæåˆ°äº†ç±»åŠ è½½æœºåˆ¶å’ŒåŒäº²å§”æ´¾æ¨¡å‹ï¼Œæˆ‘è¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚



## 1ã€ç±»åŠ è½½è¿‡ç¨‹

é¦–å…ˆæˆ‘ä»¬çŸ¥é“ä¸€ä¸ª`.java`æ–‡ä»¶å®ƒçš„ç¼–è¯‘è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š

![](https://cdn.jsdelivr.net/gh/DogerRain/image@main/Home/image-20201014154245544.png)



ä¸Šé¢å›¾ä¸­æè¿°çš„æ˜¯å®è§‚çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å¾®è§‚çš„è¿‡ç¨‹å¹¶æ²¡æœ‰æåŠï¼Œè€Œå¾®è§‚è¿‡ç¨‹çš„`.class`å­—èŠ‚ç æ˜¯å¦‚ä½•è§£é‡Šæˆæœºå™¨ç è€Œè¢«ä¸åŒçš„å¹³å°æ‰§è¡Œçš„å‘¢ï¼Ÿ

è¿™å°±æ˜¯æˆ‘ä»¬æœ¬ç¯‡æ–‡ç« ç ”ç©¶çš„ **ç±»åŠ è½½è¿‡ç¨‹å’ŒåŒäº²å§”æ´¾æ¨¡å‹**



å†è¿›ä¸€æ­¥æ‹†åˆ†ï¼Œå®ƒå…¶å®æ˜¯è¿™æ ·çš„ï¼š

![](https://cdn.jsdelivr.net/gh/DogerRain/image@main/Home/image-20210515133357253.png)

ä¸”çœ‹çœ‹[ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹](https://union-click.jd.com/jdc?e=&p=JF8AAMUDIgZlGmsVARUGUxhTHTJWWA1FBCVbV0IUWVALHEpCAUdETlcNVQtHRRUBFQZTGFMdHUtCCUZrYFRgbj5_UlFhcR1LYF8WQm9VJ2sdQw4eN1QrWxQDEQRRHFgSAyI3VRxrQ2wSBlQaWhQHEwNWK1olAhUEVRpfEgEbBVMZUyUFEg5lQA57BxEPB0laEQYSDlYaWiUyIgRlK2sVMhE3F3UMRVcTDwAaDhVSGg9QTlITURYOBRhfFFBHDgAZCRcGGzdXGloRCw)ä¸­å¯¹ç±»åŠ è½½è¿‡ç¨‹çš„å®šä¹‰ï¼šè™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä»classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æã€åˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Javaç±»å‹ã€‚

ç±»ä»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­å¼€å§‹ï¼Œå®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ï¼š

**åŠ è½½ -> éªŒè¯ -> å‡†å¤‡ -> è§£æ -> åˆå§‹åŒ– -> ä½¿ç”¨ -> å¸è½½**

![](https://cdn.jsdelivr.net/gh/DogerRain/image@main/Home/image-20210515133858799.png)

### 1ã€åŠ è½½

**åŠ è½½åˆ†ä¸ºä¸‰æ­¥ï¼š**

ç¬¬ä¸€æ­¥ï¼šé€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„**äºŒè¿›åˆ¶å­—èŠ‚æµ**ã€‚

ç¬¬äºŒæ­¥ï¼šå°†é™æ€çš„å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚

ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆä¸€ä¸ªå¯¹è±¡æ”¾å…¥javaå †ä¸­ï¼Œ**ä½œä¸ºå¯¹æ–¹æ³•åŒºçš„å¼•ç”¨**ã€‚

ï¼ˆç±»çš„åŠ è½½å°±æ˜¯å°†classæ–‡ä»¶ä¸­çš„äºŒè¿›åˆ¶æ•°æ®è¯»å–åˆ°å†…å­˜ä¸­ï¼Œç„¶åå°†è¯¥å­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€æ•°æ®ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºä¸­è¿è¡Œçš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”åœ¨å †å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ª`java.lang.Class`å¯¹è±¡ä½œä¸ºè®¿é—®æ–¹æ³•åŒºæ•°æ®ç»“æ„çš„å…¥å£ï¼‰



> å¯¹äºç¬¬ä¸€æ­¥çš„**äºŒè¿›åˆ¶å­—èŠ‚æµ**ï¼Œå…¶å®è¿™ä¸ªè™šæ‹Ÿæœºå¹¶æ²¡æœ‰è¯´çš„å¾ˆå…·ä½“ï¼Œæ‰€ä»¥è¯´ç°åœ¨å¾ˆå¤šå¼€å‘äººå‘˜éƒ½å¯ä»¥æ‰“ç ´å®ƒï¼Œæ¯”å¦‚è¯´
> 1ã€é€šè¿‡jarã€zipã€war è·å–
>
> 2ã€æä¾›ç½‘ç»œè·å–ï¼Œæ¯”å¦‚è¯´applet
>
> 3ã€åŠ¨æ€ä»£ç†
>
> 4ã€JSPè¿™ç§ï¼Œç¼–è¯‘åè¿˜æ˜¯ä¸€ä¸ªclassç±»

### 2ã€éªŒè¯

éªŒè¯ä¸»è¦çš„ç›®çš„æ˜¯**ä¸ºäº†ç¡®ä¿classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨**ã€‚

> æ‰€ä»¥è¯´Javaè™šæ‹Ÿæœºå¹¶ä¸æ˜¯å®Œå…¨ä¿¡ä»»åŠ è½½è¿‡æ¥çš„å­—èŠ‚æµã€‚

æ•´ä½“ä¸ŠéªŒè¯åˆ†ä¸ºå››ä¸ªåŠ¨ä½œï¼š

-  **æ–‡ä»¶æ ¼å¼éªŒè¯**

åŒ…æ‹¬ classæ–‡ä»¶çš„è¡¨ç¤ºï¼ˆé­”æ•°ï¼‰ï¼Œclassæ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼Œclassæ–‡ä»¶çš„æ¯ä¸ªéƒ¨åˆ†æ˜¯å¦æ­£ç¡®ï¼ˆå­—æ®µè¡¨ã€æ–¹æ³•è¡¨ç­‰ï¼‰ï¼ŒéªŒè¯å¸¸é‡æ± ï¼ˆå¸¸é‡ç±»å‹ã€å¸¸é‡ç±»å‹æ•°æ®ç»“æ„æ˜¯å¦æ­£ç¡®ï¼Œutf-8æ˜¯å¦æ ‡å‡†ï¼‰ï¼Œï¼Œå­—èŠ‚ç ï¼ˆæŒ‡ä»¤ï¼‰éªŒè¯ï¼Œç¬¦å·å¼•ç”¨éªŒè¯ï¼ˆæ˜¯å¦èƒ½æ ¹æ®ç¬¦å·æ‰¾åˆ°å¯¹åº”çš„å­—æ®µã€è¡¨ã€æ–¹æ³•ç­‰ï¼‰

**åªæœ‰é€šè¿‡äº†ç¬¬ä¸€æ­¥çš„æ–‡ä»¶æ ¼å¼éªŒè¯ï¼Œå­—èŠ‚æµæ‰ä¼šè¿›å…¥åˆ°å†…å­˜çš„æ–¹æ³•åŒºä¸­è¿›è¡Œå­˜å‚¨ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„ä¸‰ä¸ªéªŒè¯é˜¶æ®µéƒ½æ˜¯åŸºäºæ–¹æ³•åŒºçš„å­˜å‚¨ç»“æ„è¿›è¡Œçš„ï¼Œä¸ä¼šå†ç›´æ¥æ“ä½œå­—èŠ‚æµã€‚**

- **å…ƒæ•°æ®éªŒè¯**

å…ƒæ•°æ®éªŒè¯ï¼ˆçˆ¶ç±»éªŒè¯ï¼Œç»§æ‰¿éªŒè¯ï¼ŒfinaléªŒè¯ï¼‰ï¼Œæ¯”å¦‚è¯´æ˜¯å¦ç»§æ‰¿äº†ä¸å…è®¸è¢«ç»§æ‰¿çš„ç±»ï¼ˆå³finalä¿®é¥°çš„ç±»ï¼‰ã€æ˜¯å¦å®ç°ç±»æŠ½è±¡ç±»çš„æ–¹æ³•ã€é‡è½½å›å‚ã€ç±»å‹æ˜¯å¦ä¸€æ ·

- **å­—èŠ‚ç éªŒè¯**

è¿™ä¸ªé˜¶æ®µæ˜¯æœ€å¤æ‚çš„ï¼Œä¸»è¦ç›®çš„æ˜¯**é€šè¿‡æ•°æ®æµå’Œæ§åˆ¶æµåˆ†æï¼Œç¡®å®šç¨‹åºè¯­ä¹‰æ˜¯åˆæ³•çš„ã€ç¬¦åˆé€»è¾‘çš„ã€‚**

å¦‚æœä¸€é¡¹ä¸å¯¹ï¼Œå°±ä¼šéªŒè¯å¤±è´¥ã€‚

- **ç¬¦å·å¼•ç”¨éªŒè¯**

è¿™ä¸€æ­¥å‘ç”Ÿåœ¨è™šæ‹Ÿæœºå°†ç¬¦åˆå¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™ï¼Œ**ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿ è§£æ åŠ¨ä½œèƒ½æ­£å¸¸æ‰§è¡Œã€‚**æ¯”å¦‚è¯´ç±»æ˜¯å¦èƒ½æ‰¾åˆ°ã€è®¿é—®ç±»çš„å­—æ®µã€æ–¹æ³•æ˜¯å¦è¢«privateä¿®é¥°æ— æ³•è®¿é—®äº†ã€‚

### 3ã€å‡†å¤‡

   å‡†å¤‡é˜¶æ®µä¸ºç±»å˜é‡åˆ†é…å†…å­˜ å’Œè®¾ç½®ç±»å˜é‡åˆå§‹åŒ–ã€‚

è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œ**åªå¯¹staticç±»å˜é‡è¿›è¡Œå†…å­˜åˆ†é…**ï¼Œè¿™ä¸ªæ—¶å€™åªæ˜¯åˆ†é…å†…å­˜ï¼Œæ²¡æœ‰è¿›è¡Œå¤åˆ¶ï¼Œæ‰€æœ‰çš„ç±»å˜é‡éƒ½æ˜¯åˆå§‹åŒ–å€¼ã€‚

**å¦‚æœæ˜¯finalçš„è¯ï¼Œä¼šç›´æ¥å¯¹åº”åˆ°å¸¸é‡æ± ä¸­ã€‚ä¼šåœ¨å‡†å¤‡é˜¶æ®µç›´æ¥èµ‹å€¼ã€‚**

```java
public static final int value = 123;
```

è¿™é‡Œå˜é‡çš„åˆå§‹åŒ–å€¼æ˜¯0 è€Œä¸æ˜¯ 123ï¼Œ123åœ¨åˆå§‹åŒ–é˜¶æ®µæ‰ä¼šèµ‹å€¼ã€‚



é¢˜å¤–è¯ï¼Œè¿™é‡Œæˆ‘æ¼”ç¤ºä¸€ä¸‹ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹ï¼š

è¿™æ˜¯æˆ‘çš„`HelloCoder.java` æ–‡ä»¶ï¼š

```java
package com.yudianxx.basic.å­—èŠ‚ç ;
/**
 * @author HaC
 * @date 2021/5/15 14:26
 * @webSite https://rain.baimuxym.cn
 * @Description
 */
public class HelloCoder {
    public static int staticValue = 123;
    public static final int  finalValue = 456;

    public static void main(String[] args) {
        System.out.println(staticValue);
        System.out.println(finalValue);
    }
}

```

ä½¿ç”¨å‘½ä»¤æ‰“å°ä¸€ä¸‹å­—èŠ‚ç ï¼š

```java
javap -verbose -private -c -s -l HelloCoder
```

è¿™æ˜¯å­—èŠ‚ç ï¼š

```java
Classfile /G:/æºç /springBootLogback/yudianxx-core/target/classes/com/yudianxx/basic/å­—èŠ‚ç /HelloCoder.class
  Last modified 2021-5-15; size 712 bytes
  MD5 checksum ac91b5504efcf6aa372cdc10cd899626
  Compiled from "HelloCoder.java"
public class com.yudianxx.basic.å­—èŠ‚ç .HelloCoder
  minor version: 0
  major version: 52
  flags: ACC_PUBLIC, ACC_SUPER
Constant pool:
   #1 = Methodref          #6.#26         // java/lang/Object."<init>":()V
   #2 = Fieldref           #27.#28        // java/lang/System.out:Ljava/io/PrintStream;
   #3 = Fieldref           #5.#29         // com/yudianxx/basic/å­—èŠ‚ç /HelloCoder.staticValue:I
   #4 = Methodref          #30.#31        // java/io/PrintStream.println:(I)V
   #5 = Class              #32            // com/yudianxx/basic/å­—èŠ‚ç /HelloCoder
   #6 = Class              #33            // java/lang/Object
   #7 = Utf8               staticValue
   #8 = Utf8               I
   #9 = Utf8               finalValue
  #10 = Utf8               ConstantValue
  #11 = Integer            456
  #12 = Utf8               <init>
  #13 = Utf8               ()V
  #14 = Utf8               Code
  #15 = Utf8               LineNumberTable
  #16 = Utf8               LocalVariableTable
  #17 = Utf8               this
  #18 = Utf8               Lcom/yudianxx/basic/å­—èŠ‚ç /HelloCoder;
  #19 = Utf8               main
  #20 = Utf8               ([Ljava/lang/String;)V
  #21 = Utf8               args
  #22 = Utf8               [Ljava/lang/String;
  #23 = Utf8               <clinit>
  #24 = Utf8               SourceFile
  #25 = Utf8               HelloCoder.java
  #26 = NameAndType        #12:#13        // "<init>":()V
  #27 = Class              #34            // java/lang/System
  #28 = NameAndType        #35:#36        // out:Ljava/io/PrintStream;
  #29 = NameAndType        #7:#8          // staticValue:I
  #30 = Class              #37            // java/io/PrintStream
  #31 = NameAndType        #38:#39        // println:(I)V
  #32 = Utf8               com/yudianxx/basic/å­—èŠ‚ç /HelloCoder
  #33 = Utf8               java/lang/Object
  #34 = Utf8               java/lang/System
  #35 = Utf8               out
  #36 = Utf8               Ljava/io/PrintStream;
  #37 = Utf8               java/io/PrintStream
  #38 = Utf8               println
  #39 = Utf8               (I)V
{
  public static int staticValue;
    descriptor: I
    flags: ACC_PUBLIC, ACC_STATIC

  public static final int finalValue;
    descriptor: I
    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL
    ConstantValue: int 456  //ConstantValueæŒ‡ä»¤

  public com.yudianxx.basic.å­—èŠ‚ç .HelloCoder(); //æ„é€ æ–¹æ³•
    descriptor: ()V
    flags: ACC_PUBLIC
    Code:
      stack=1, locals=1, args_size=1
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object."<init>":()V
         4: return
      LineNumberTable:
        line 9: 0
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       5     0  this   Lcom/yudianxx/basic/å­—èŠ‚ç /HelloCoder;

  public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: ACC_PUBLIC, ACC_STATIC
    Code:
      stack=2, locals=1, args_size=1
         0: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
         3: getstatic     #3                  // Field staticValue:I
         6: invokevirtual #4                  // Method java/io/PrintStream.println:(I)V
         9: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
        12: sipush        456
        15: invokevirtual #4                  // Method java/io/PrintStream.println:(I)V
        18: return
      LineNumberTable:
        line 14: 0
        line 15: 9
        line 16: 18
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0      19     0  args   [Ljava/lang/String;

  static {}; //è¿™é‡Œæ˜¯staticè¯­æ³•å—
    descriptor: ()V
    flags: ACC_STATIC
    Code:
      stack=1, locals=0, args_size=0
         0: bipush        123
         2: putstatic     #3                  // é€šè¿‡æŒ‡ä»¤putstaticæ ‡å¿—ä½åˆå§‹åŒ–å€¼
         5: return
      LineNumberTable:
        line 10: 0
}
SourceFile: "HelloCoder.java"

```

ä»¥ä¸Šå­—èŠ‚ç ä¸­ï¼Œstatic çš„å€¼ä¼šé€šè¿‡`putstatic`æŒ‡ä»¤æ ‡å¿—ï¼Œå­˜æ”¾äºç±»æ„é€ å™¨`<clinit>()` æ–¹æ³•ä¸­ï¼Œfinal çš„å€¼åˆ™æ˜¯ `ConstantValue` æŒ‡ä»¤



### 4ã€è§£æ

**è§£æé˜¶æ®µå°±æ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ï¼ˆæŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆæˆ–è€…åç§»é‡ï¼‰**

> ç¬¦å·å¼•ç”¨  æ˜¯ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ï¼Œåªæ˜¯å®šä½ç›®æ ‡ï¼Œå’Œè™šæ‹Ÿæœºçš„å†…å­˜å¸ƒå±€æ— å…³ï¼Œæ‰€ä»¥å®ƒä¸ä¸€å®šå·²ç»åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä¸åŒçš„è™šæ‹Ÿæœºçš„å†…å­˜å¸ƒå±€ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ï¼Œä½†æ˜¯ç¬¦å·æ ‡æ³¨éƒ½æ˜¯ä¸€æ ·çš„ã€‚
>
> ç›´æ¥å¼•ç”¨ ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡ï¼Œå’Œè™šæ‹Ÿæœºçš„å†…å­˜å¸ƒå±€æ˜¯ç›´æ¥ç›¸å…³çš„ï¼Œå¦‚æœæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£ä¹ˆå¼•ç”¨çš„ç›®æ ‡å¿…å®šå·²ç»å­˜åœ¨å†…å­˜ä¸­äº†ã€‚

ä¸»è¦æ¶‰åŠåˆ°çš„è§£ææœ‰ç±»ï¼Œæ¥å£ï¼Œå­—æ®µï¼Œæ–¹æ³•ç­‰ã€‚ å¦‚æœæƒé™ä¸å¤Ÿå°±ä¼šæŠ›å‡º`IllegalAccessError`ï¼Œæ‰¾ä¸åˆ°å­—æ®µå°±ä¼šæŠ›å‡º`NoSuchFiledError`ã€æ‰¾ä¸åˆ°æ–¹æ³•å°±ä¼šæŠ›å‡º`NoSuchMethodError`

### 5ã€åˆå§‹åŒ–

ç±»åˆå§‹åŒ–å°±æ˜¯æ‰§è¡Œç±»ä¸­å®šä¹‰çš„Javaç¨‹åºä»£ç ï¼ˆæˆ–è€…è¯´æ˜¯å­—èŠ‚ç ï¼‰ï¼Œä»å­—èŠ‚ç å±‚é¢æ¥è¯´ï¼Œåˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨`<clinit>()`æ–¹æ³•çš„è¿‡ç¨‹ã€‚

åŒ…æ‹¬`static{ }` ä»£ç å—çš„è¯­å¥æ‰§è¡Œå’Œstaticå˜é‡èµ‹å€¼ï¼ˆå¯ä»¥å‚è€ƒä¸Šé¢ï¼Œstatic ä¿®é¥°çš„åœ¨è¿™é‡Œçš„åˆå§‹åŒ–é˜¶æ®µè¿›è¡Œèµ‹å€¼ï¼Œè€Œä¸”æ˜¯çˆ¶ç±»çš„`<clinit>()`å…ˆæ‰§è¡Œï¼Œå¦‚æœç¨‹åºæ²¡æœ‰staticï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥ä¸ç”Ÿæˆ`<clinit>()`æ–¹æ³•ï¼‰

### 6ã€ä½¿ç”¨

   ä½¿ç”¨é˜¶æ®µå°±æ˜¯ä½¿ç”¨è¿™ä¸ªclassã€‚ 

### 7ã€å¸è½½

   å¸è½½é˜¶æ®µå°±æ˜¯ä¸åœ¨ä½¿ç”¨ï¼Œå°†classç»™å¸è½½ã€‚



## 2ã€åŒäº²å§”æ´¾æ¨¡å‹

![](https://cdn.jsdelivr.net/gh/DogerRain/image@main/Home/image-20210515131534794.png)

**ç±»åŠ è½½å™¨çš„ç§ç±»ï¼š**

- å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥åŠ è½½Java_HOME/lib/ç›®å½•ä¸­çš„ï¼Œæˆ–è€…è¢« -Xbootclasspath å‚æ•°æ‰€æŒ‡å®šçš„è·¯å¾„ä¸­å¹¶ä¸”è¢«è™šæ‹Ÿæœºè¯†åˆ«çš„ç±»åº“ï¼›

- æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½\lib\extç›®å½•æˆ–Java. ext. dirsç³»ç»Ÿå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­çš„æ‰€æœ‰ç±»åº“ï¼›

- åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ã€‚è´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆclasspathï¼‰ä¸Šçš„æŒ‡å®šç±»åº“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç±»åŠ è½½å™¨ã€‚ä¸€èˆ¬æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰è‡ªå®šä¹‰ç±»åŠ è½½å™¨é»˜è®¤å°±æ˜¯ç”¨è¿™ä¸ªåŠ è½½å™¨ã€‚



### 1ã€åŒäº²å§”æ´¾çš„å·¥ä½œæµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ

å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½çš„è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œå±‚å±‚å¥—å¨ƒï¼ˆè‘«èŠ¦å¨ƒä»¬ï¼‰ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€ç»ˆæ˜¯é€åˆ°é¡¶å±‚çš„ **å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰**ï¼Œåªæœ‰å½“çˆ¶ç±»ï¼ˆè‘«èŠ¦å¨ƒçˆ·çˆ·ğŸ‘´ï¼‰åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚



### 2ã€ä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ

é‡‡ç”¨åŒäº²å§”æ´¾æ¨¡å¼çš„æ˜¯å¥½å¤„æ˜¯Javaç±»éšç€å®ƒçš„ç±»åŠ è½½å™¨ä¸€èµ·å…·å¤‡äº†ä¸€ç§å¸¦æœ‰ä¼˜å…ˆçº§çš„å±‚æ¬¡å…³ç³»ï¼Œé€šè¿‡è¿™ç§å±‚çº§å…³å¯ä»¥é¿å…ç±»çš„é‡å¤åŠ è½½ï¼Œå½“çˆ¶äº²å·²ç»åŠ è½½äº†è¯¥ç±»æ—¶ï¼Œå°±æ²¡æœ‰å¿…è¦å­ClassLoaderå†åŠ è½½ä¸€æ¬¡ã€‚

å…¶æ¬¡æ˜¯è€ƒè™‘åˆ°å®‰å…¨å› ç´ ï¼Œjavaæ ¸å¿ƒapiä¸­å®šä¹‰ç±»å‹ä¸ä¼šè¢«éšæ„æ›¿æ¢ï¼Œå‡è®¾é€šè¿‡ç½‘ç»œä¼ é€’ä¸€ä¸ªåä¸º`java.lang.Integer`çš„ç±»ï¼Œé€šè¿‡åŒäº²å§”æ‰˜æ¨¡å¼ä¼ é€’åˆ°å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œè€Œ**å¯åŠ¨ç±»åŠ è½½å™¨**åœ¨æ ¸å¿ƒJava APIå‘ç°è¿™ä¸ªåå­—çš„ç±»ï¼Œå‘ç°è¯¥ç±»å·²è¢«åŠ è½½ï¼Œ**å¹¶ä¸ä¼šé‡æ–°åŠ è½½ç½‘ç»œä¼ é€’çš„è¿‡æ¥çš„**`java.lang.Integer`ï¼Œè€Œç›´æ¥è¿”å›å·²åŠ è½½è¿‡çš„`Integer.class`ï¼Œè¿™æ ·ä¾¿å¯ä»¥é˜²æ­¢æ ¸å¿ƒAPIåº“è¢«éšæ„ç¯¡æ”¹ã€‚



### 3ã€JVMä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šåŠ è½½ä¸€ä¸ªç±»ï¼Ÿ

Javaè™šæ‹Ÿæœºè§„èŒƒä¸­å¹¶æ²¡æœ‰è¿›è¡Œå¼ºåˆ¶çº¦æŸï¼Œè¿™ä¸ªå¯ä»¥äº¤ä¸ªè™šæ‹Ÿæœºçš„å…·ä½“å®ç°æ¥è‡ªå·±æŠŠæ¡ã€‚

ä½†å¯¹äº**åˆå§‹åŒ–**é˜¶æ®µï¼Œè™šæ‹Ÿæœºè§„èŒƒåˆ™æ˜¯ä¸¥æ ¼è§„å®šæ¥æœ‰ä¸”5ç§æƒ…å†µå¿…é¡»ç«‹å³å¯¹ç±»è¿›è¡Œ**åˆå§‹åŒ–**ï¼Œï¼ˆè¿™é‡Œè¯´çš„åˆå§‹åŒ–ä¸¥æ ¼æ¥è¯´æ˜¯åŒ…æ‹¬ä¹‹å‰çš„åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€‚ï¼‰

1ã€é‡åˆ°`new`ã€`getstatic`ã€`putstatic`ã€`invokestatic` è¿™å››ä¸ªæŒ‡ä»¤ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚æœ€å¸¸è§çš„å°±æ˜¯newä¸€ä¸ªå¯¹è±¡ã€è¯»å–ä¸€ä¸ªç±»çš„staticå˜é‡ã€‚

2ã€åå°„ã€‚æ¯”å¦‚`Class.forName("className")`

3ã€å½“å­ç±»è¢«åŠ è½½æ—¶ï¼Œå¦‚æœçˆ¶ç±»è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚

4ã€JVMå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦åˆ¶å®šä¸€ä¸ªæ‰§è¡Œçš„ä¸»ç±»ï¼Œæ¯”å¦‚è¯´æ‰§è¡Œmainæ–¹æ³•ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»

5ã€å½“ä½¿ç”¨JDK1.7åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª`java.lang.invoke.MethodHandle`å®ä¾‹æœ€åçš„è§£æç»“æœä¸º`REF_getStatic`ã€`REF_putStatic`ã€`REF_invokeStatic`çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„çš„æ‰€å¯¹åº”çš„ç±»è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆåˆå§‹åŒ–ã€‚ï¼ˆè¿™ä¸ªæˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šæ˜¯ä»€ä¹ˆæ„æ€ï¼‰







### 4ã€æ‰‹å†™ä¸€ä¸ªè‡ªå®šä¹‰ç±»åŠ è½½å™¨

é¦–å…ˆè¦çŸ¥é“ClassLoaderçš„æºç å®ç°ï¼š

```java
protected Class<?> loadClass(String name, boolean resolve)
        throws ClassNotFoundException
    {
        synchronized (getClassLoadingLock(name)) {
            // First, check if the class has already been loaded
            Class<?> c = findLoadedClass(name); //é¦–å…ˆæŸ¥æ‰¾.classæ˜¯å¦è¢«åŠ è½½è¿‡
            if (c == null) {
                long t0 = System.nanoTime();
                try {
                    if (parent != null) {
                        //å¦‚æœçˆ¶åŠ è½½å™¨ä¸æ˜¯nullï¼ˆä¸æ˜¯Bootstrap ClassLoaderï¼‰ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œçˆ¶åŠ è½½å™¨çš„loadClassæ–¹æ³•
                        //æŠŠç±»åŠ è½½è¯·æ±‚ä¸€ç›´å‘ä¸ŠæŠ›ï¼Œç›´åˆ°çˆ¶åŠ è½½å™¨ä¸ºnullï¼ˆæ˜¯Bootstrap ClassLoaderï¼‰ä¸ºæ­¢
                        c = parent.loadClass(name, false);  
                    } else {
                        c = findBootstrapClassOrNull(name);
                    }
                } catch (ClassNotFoundException e) {
                   
                }
 				//å¦‚æœçˆ¶ç±»éƒ½åŠ è½½å¤±è´¥å°±äº¤ç»™å­åŠ è½½å™¨å»åŠ è½½
                if (c == null) {
                  
                    long t1 = System.nanoTime();
                    c = findClass(name);

                    // this is the defining class loader; record the stats
                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);
                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);
                    sun.misc.PerfCounter.getFindClasses().increment();
                }
            }
            //æ˜¯å¦è§£æè¿™ä¸ª.class,ä¸»è¦å°±æ˜¯å°†ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹
            if (resolve) {
                resolveClass(c);
            }
            return c;
        }
    }
    
    protected Class<?> findClass(String name) throws ClassNotFoundException {
        throw new ClassNotFoundException(name);
    }
```

1ã€å¦‚æœä¸æƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œé‚£ä¹ˆåªéœ€è¦é‡å†™`findClass`æ–¹æ³•å³å¯

2ã€å¦‚æœæƒ³æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Œé‚£ä¹ˆå°±é‡å†™æ•´ä¸ª`loadClass`æ–¹æ³•

jdk1.2å¼€å§‹ï¼Œä¸æå€¡ç”¨æˆ·å»è¦†ç›–`loadClass()`æ–¹æ³•ï¼Œè€Œåº”è¯¥å†™åˆ°`findClass()`æ–¹æ³•ï¼Œè¿™æ ·ä¿è¯è‡ªå·±å®ç°çš„ç±»åŠ è½½å™¨ä¹Ÿæ˜¯ç¬¦åˆåŒäº²å§”æ´¾æ¨¡å‹çš„ã€‚

ä¸‹é¢ä¸Šä»£ç ã€‚

**å®ä½“ç±»ï¼š**

```java
@Data
@AllArgsConstructor
public class HaC {
    String name;
    String wx;
}
```

è¿™ä¸ª`HaC.java` ç¼–è¯‘å¥½ï¼Œå¤åˆ¶åˆ°å…¶ä»–è·¯å¾„ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ­¥æ“ä½œã€‚

**é‡å†™ClassLoaderï¼š**

```java
class MyClassLoader extends ClassLoader {
    public MyClassLoader() {

    }

    public MyClassLoader(ClassLoader parent) {
        super(parent);
    }

    @Override
    protected Class<?> findClass(String name) throws ClassNotFoundException {
        File file = getClassFile(name);
        try {
            byte[] bytes = getClassBytes(file);
            Class<?> c = this.defineClass(name, bytes, 0, bytes.length);
            return c;
        } catch (Exception e) {
            e.printStackTrace();
        }

        return super.findClass(name);
    }

    private File getClassFile(String name) {
             File file = new File("G:\\HaC.class" );
  //      File file = new File("G:\\æºç \\springBootLogback\\yudianxx-core\\target\\classes\\com\\yudianxx\\basic\\ç±»åŠ è½½è¿‡ç¨‹\\HaC.class" );
        return file;
    }

    private byte[] getClassBytes(File file) throws Exception {
        // è¿™é‡Œè¦è¯»å…¥.classçš„å­—èŠ‚ï¼Œå› æ­¤è¦ä½¿ç”¨å­—èŠ‚æµ
        FileInputStream fis = new FileInputStream(file);
        FileChannel fc = fis.getChannel();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        WritableByteChannel wbc = Channels.newChannel(baos);
        ByteBuffer by = ByteBuffer.allocate(1024);

        while (true) {
            int i = fc.read(by);
            if (i == 0 || i == -1)
                break;
            by.flip();
            wbc.write(by);
            by.clear();
        }

        fis.close();

        return baos.toByteArray();
    }
}

class TestMyClassLoader {
    public static void main(String[] args) throws Exception {
        MyClassLoader myClassLoader = new MyClassLoader(ClassLoader.getSystemClassLoader().getParent());
        Class<?> c1 = Class.forName("com.yudianxx.basic.ç±»åŠ è½½è¿‡ç¨‹.HaC", true, myClassLoader);
        Constructor constructor = c1.getConstructor(String.class, String.class);//è·å¾—æ„é€ æ–¹æ³•
        Object object = constructor.newInstance("HaC", "å…¬ä¼—å·ï¼šHelloCoder"); //åå°„å®ä¾‹åŒ–å¯¹è±¡
        System.out.println(object);
        System.out.println(object.getClass().getClassLoader());
    }
}
```

è¾“å‡ºï¼š

```java
HaC(name=HaC, wx=å…¬ä¼—å·ï¼šHelloCoder)
com.yudianxx.basic.ç±»åŠ è½½è¿‡ç¨‹.MyClassLoader@2c13da15
```

> å¦‚æœç¬¬äºŒè¡Œè¾“å‡º sun.misc.Launcher$AppClassLoader è¯æ˜è¿˜æ˜¯æ²¡æœ‰ç”¨åˆ°è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œå› ä¸ºæ­£å¸¸æ¥è¯´ï¼ŒClassLoaderçš„getResourceAsStream(String name)æ–¹æ³•ï¼Œé»˜è®¤å°±æ˜¯ä»CLASSPATHä¸‹è·å–èµ„æºçš„ï¼Œå°±æ˜¯è¦è®©AppClassLoader å»å¤„ç†ç±»çš„åŠ è½½çš„ã€‚
>
> å¦‚æœæŠ¥è¿™ä¸ªé”™ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š

**1ã€ç¬¬ä¸€ç§è§£å†³æ–¹æ³•**

è¿™é‡Œ `MyClassLoader myClassLoader = new MyClassLoader(ClassLoader.getSystemClassLoader().getParent());` å¦‚æœæ²¡æœ‰ä¼ å…¥æ„é€ å‚æ•°ï¼Œæ˜¯ä¸ä¼šåˆ©ç”¨è‡ªå·±çš„è‡ªå®šä¹‰åŠ è½½å™¨å»åŠ è½½çš„ã€‚

å› ä¸ºä½ çš„CLASSPATHä¸‹é¢å°±ç¼–è¯‘æœ‰äº† `HaC.class`ï¼Œé‚£ä¹ˆè‡ªç„¶æ˜¯ç”±**AppClassLoader**è¿™ä¸ªçˆ¸çˆ¸æ¥åŠ è½½è¿™ä¸ª`.class`æ–‡ä»¶äº†ï¼ˆå“ªè½®å¾—åˆ°å„¿å­`MyClassLoader` å»åŠ è½½ï¼‰

`ClassLoader.getSystemClassLoader()` å°±æ˜¯ **AppClassLoader**ï¼Œæˆ‘ä»¬å®šä¹‰

`ClassLoader.getSystemClassLoader().getParent()` è¶Šè¿‡å®ƒï¼Œè®©çˆ·çˆ·ï¼ˆ**Extension ClassLoade**rï¼‰å»åŠ è½½ï¼Œçˆ·çˆ·æ‰¾ä¸åˆ°ï¼Œå†è®©å¤ªçˆ·çˆ·ï¼ˆ**Bootstrap ClassLoader**ï¼‰å»æ‰¾ï¼Œå®ƒä¹Ÿæ²¡åŠæ³•å¤„ç†ï¼Œæœ€åè°ƒç”¨`findClass`æ–¹æ³•ã€‚

**2ã€ç¬¬äºŒç§è§£å†³æ–¹æ³•**

åˆ é™¤CLASSPATHä¸‹çš„Person.classï¼Œè¿™æ ·å®ƒå°±æ‰¾ä¸åˆ°äº†ï¼Œæ‰€ä»¥çˆ¸çˆ¸ã€çˆ·çˆ·ã€å¤ªçˆ·çˆ·è¿™ä¸‰ä¸ªåŠ è½½å™¨éƒ½æ‰¾ä¸åˆ°äº†ã€‚