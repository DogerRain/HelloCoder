(window.webpackJsonp=window.webpackJsonp||[]).push([[313],{725:function(t,a,s){"use strict";s.r(a);var n=s(7),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("上一篇文章"),a("a",{attrs:{href:"https://blog.csdn.net/yudianxiaoxiao/article/details/109589101",target:"_blank",rel:"noopener noreferrer"}},[t._v("【教你搭建服务器系列】（2）搭建服务器环境，安装JDK、MySQL、Redis、Tomcat、Nginx"),a("OutboundLink")],1),t._v("我们已经部署好了服务器的环境，那么接下来我们就可以部署我们的项目了。")]),t._v(" "),a("p",[t._v("本篇文章准备了一个静态的HTML网页，手把手从0开始教你部署一个网站。")]),t._v(" "),a("p",[t._v("本篇文章部署的网站成品： "),a("a",{attrs:{href:"https://www.baimuxym.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.baimuxym.cn"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("本篇文章演示的是部署在Centos7、Tomcat8.0的服务器")])]),t._v(" "),a("h2",{attrs:{id:"_1、准备项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、准备项目"}},[t._v("#")]),t._v(" 1、准备项目")]),t._v(" "),a("p",[t._v("通过ftp把"),a("strong",[t._v("项目")]),t._v("上传到服务器。上传到  "),a("code",[t._v("/var/www/web/HaCresume")])]),t._v(" "),a("p",[t._v("如果你没有网站，可以在这里找到："),a("a",{attrs:{href:"https://github.com/DogerRain/HaCresume",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/DogerRain/HaCresume"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("clone 到本地即可。")]),t._v(" "),a("p",[t._v("目录结构如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20201012145731521.png",alt:" "}})]),t._v(" "),a("p",[t._v("找到tomcat目录下的"),a("code",[t._v("conf/server.xml")]),t._v("文件，在末尾  "),a("code",[t._v("<host> </host>")]),t._v("标签之间添加上：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Context")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("docBase")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/var/www/web/HaCresume/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("debug")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("reloadable")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("p",[t._v("表示Tomcat的根目录就是这个了，不再是webapps下面了。")]),t._v(" "),a("p",[t._v("找到tomcat目录下的conf/web.xml文件，修改首页：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file-list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.html"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.htm"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.jsp"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file-list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("表示我的 首页 就是  "),a("code",[t._v("/var/www/web/HaCresume/index.html")]),t._v(" 了。")]),t._v(" "),a("p",[t._v("然后重启Tomcat，浏览器输入 你的服务器IP + 端口"),a("code",[t._v("http://81.71.16.134:8080/")])]),t._v(" "),a("p",[t._v("即可访问了：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20201012150846031-11.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("注意：如果你开启了Nginx，需要把Nginx的80端口放开监听，或者关闭Nginx")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("/usr/local/nginx/sbin//nginx -s stop\n")])])]),a("p",[a("strong",[t._v("虽然现在访问没有问题，但是还有几个问题：")])]),t._v(" "),a("p",[t._v("1、 网站提示连接是不安全的。")]),t._v(" "),a("p",[t._v("2、 能不能访问的时候不需要带端口？")]),t._v(" "),a("p",[t._v("3、能不能通过域名访问，就像 "),a("a",{attrs:{href:"www.baidu.com"}},[t._v("www.baidu.com")]),t._v(" 这样直接访问网站？。")]),t._v(" "),a("p",[t._v("如果你想深入的了解，那么就继续往下看。")]),t._v(" "),a("h2",{attrs:{id:"_2、域名注册、解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、域名注册、解析"}},[t._v("#")]),t._v(" 2、域名注册、解析")]),t._v(" "),a("p",[t._v("一个域名只能对应一个ip地址，而一个ip地址可以对应多个域名。")]),t._v(" "),a("p",[t._v("现在我们已经有了IP，还需要买个域名。")]),t._v(" "),a("p",[t._v("腾讯云、阿里云都可以购买域名，以腾讯云为例，登入腾讯云后台，购买符合自己的域名。")]),t._v(" "),a("p",[t._v("以腾讯云新用户为例，一般只需要1块钱一年：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20210513145741018.png",alt:""}})]),t._v(" "),a("p",[t._v("购买完成、然后实名认证（否则不能使用80端口），域名就可以绑定你的IP了，专业术语叫 "),a("strong",[t._v("解析")]),t._v("，我这里购买的域名是"),a("code",[t._v("baimuxym.cn")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://cloud.tencent.com/act/cps/redirect?redirect=10010&cps_key=664b44b4e8e43b579d07036bf1c71060",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloud.tencent.com/act/domainsales"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("解析：")])]),t._v(" "),a("p",[t._v("以腾讯云为例，登入后台，点击解析")]),t._v(" "),a("blockquote",[a("p",[t._v("解析：**解析的意思就是 把这个域名和你的服务器IP绑定")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20201011231404960.png",alt:""}})]),t._v(" "),a("p",[t._v("点击 "),a("strong",[t._v("添加记录")]),t._v(" ，你的域名还可以生成子域名，比如说 "),a("code",[t._v("baimuxym.cn")]),t._v(" 是我的一级域名，默认分配了"),a("code",[t._v("www.baimuxym.cn")]),t._v("作为二级域名；"),a("code",[t._v("www.a.baimuxym.cn")]),t._v("、"),a("code",[t._v("www.b.baimuxym.cn")]),t._v(" 也是可以的，表示三级域名。")]),t._v(" "),a("p",[t._v("我这里添加了一个 rain，"),a("code",[t._v("rain.baimuxym.cn")]),t._v(" 就是我的二级域名了，如图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20201011231636181.png",alt:""}})]),t._v(" "),a("p",[t._v("自此  "),a("code",[t._v("www.baimuxym.cn")]),t._v(" "),a("code",[t._v("rain.baimuxym.cn")]),t._v("  已经申请完成了，都是指向 "),a("code",[t._v("81.71.16.134")]),t._v(" 这台服务器。")]),t._v(" "),a("p",[t._v("怎么知道有没有解析成功呢？我们ping一下就知道了：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Administrator"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("ping www.baimuxym.cn\n\n正在 Ping www.baimuxym.cn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81.71")]),t._v(".16.134"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" 具有 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" 字节的数据:\n来自 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81.71")]),t._v(".16.134 的回复: 字节"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" 时间"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("8ms "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TTL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),t._v("\n来自 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81.71")]),t._v(".16.134 的回复: 字节"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" 时间"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("8ms "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TTL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),t._v("\n来自 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81.71")]),t._v(".16.134 的回复: 字节"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" 时间"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("8ms "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TTL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),t._v("\n来自 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81.71")]),t._v(".16.134 的回复: 字节"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" 时间"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("13ms "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TTL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("54")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81.71")]),t._v(".16.134 的 Ping 统计信息:\n    数据包: 已发送 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("，已接收 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("，丢失 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("% 丢失"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("，\n往返行程的估计时间"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("以毫秒为单位"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":\n    最短 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 8ms，最长 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 13ms，平均 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 9ms\n")])])]),a("p",[t._v("IP正是我的服务器IP，说明解析成功。")]),t._v(" "),a("p",[t._v("然后我在浏览器输入 "),a("code",[t._v("http://www.baimuxym.cn:8080/")]),t._v(" ，发现一样可以访问我的服务器了，和"),a("code",[t._v("http://81.71.16.134:8080/")]),t._v("是一样的效果。")]),t._v(" "),a("h2",{attrs:{id:"_3、修改tomcat端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、修改tomcat端口"}},[t._v("#")]),t._v(" 3、修改Tomcat端口")]),t._v(" "),a("p",[a("code",[t._v("http://www.baimuxym.cn:8080")]),t._v(" 访问还需要带端口，实在是麻烦。")]),t._v(" "),a("p",[t._v("我们知道Tomcat的默认端口是8080，那修改Tomcat额默认端口就行了。")]),t._v(" "),a("p",[t._v("找到tomcat目录下的conf/server.xml文件，修改端口：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("80"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("HTTP/1.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\n               "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("connectionTimeout")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("20000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\n               "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("redirectPort")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("p",[t._v("重启Tomcat，输入 "),a("code",[t._v("http://www.baimuxym.cn")]),t._v("，就能访问了。因为"),a("code",[t._v("http://")]),t._v("默认就是 80 端口，而我的服务器80端口恰好就是Tomcat的端口，那么自然就能访问我的项目了。")]),t._v(" "),a("blockquote",[a("p",[t._v("要使用端口，需要先在后台先开放，不然无法访问。")])]),t._v(" "),a("h2",{attrs:{id:"_4、申请ssl证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、申请ssl证书"}},[t._v("#")]),t._v(" 4、申请SSL证书")]),t._v(" "),a("p",[t._v("我们访问自己的服务器，发现只能使用"),a("code",[t._v("http://")]),t._v("访问，还"),a("strong",[t._v("提示连接不安全")]),t._v("，而使用 "),a("code",[t._v("https://")]),t._v(" 是无法访问的。")]),t._v(" "),a("p",[t._v("即"),a("code",[t._v("https://www.baimuxym.cn")]),t._v("可以访问，而"),a("code",[t._v("http://www.baimuxym.cn")]),t._v("无法访问。")]),t._v(" "),a("p",[t._v("我们知道"),a("code",[t._v("http://")]),t._v(" 是不安全的，端口为80；而"),a("code",[t._v("https://")]),t._v(" 是安全的，端口为443。")]),t._v(" "),a("p",[t._v("要想使用"),a("code",[t._v("https://")]),t._v(" ，我们就需要有SSL证书，证书可以通过两个渠道获得:")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("自己生成")])]),t._v(" "),a("li",[a("strong",[t._v("商用证书")])])]),t._v(" "),a("p",[t._v("在使用前，先把端口改了。")]),t._v(" "),a("p",[t._v("我们知道，8443是Tomcat **https://**的默认端口，就像8080是Tomcat的默认 "),a("strong",[t._v("http://")]),t._v(" 端口一样。")]),t._v(" "),a("p",[t._v("先把Tomcat的8843端口改了：")]),t._v(" "),a("p",[t._v("80跳转到443：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("80"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("HTTP/1.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\n           "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("connectionTimeout")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("20000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\n           "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("redirectPort")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("p",[t._v("8009跳转到443：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- Define an AJP 1.3 Connector on port 8009 --\x3e")]),t._v("\n\n "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8009"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("AJP/1.3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("redirectPort")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("h4",{attrs:{id:"_1、自己生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、自己生成"}},[t._v("#")]),t._v(" 1、自己生成")]),t._v(" "),a("p",[t._v("虽然安全性不是那么高,但胜在成本低。")]),t._v(" "),a("p",[t._v("下面演示一下在Tomcat下使用jdk自带的工具生成证书。")]),t._v(" "),a("h5",{attrs:{id:"_1-1、-生成keystore证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、-生成keystore证书"}},[t._v("#")]),t._v(" 1.1、 生成keystore证书")]),t._v(" "),a("p",[t._v("进入jdk的bin目录")]),t._v(" "),a("p",[t._v("执行：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("keytool -genkey -v -alias testKey -keyalg RSA -validity 3650 -keystore ~/cert/HaC.keystore\n")])])]),a("ul",[a("li",[t._v("alias: 别名 这里起名HaC.keystore")]),t._v(" "),a("li",[t._v("keyalg: 证书算法，RSA")]),t._v(" "),a("li",[t._v("validity：证书有效时间 3650，即10年")]),t._v(" "),a("li",[t._v("keystore：证书生成的目标路径和文件名,替换成你自己的路径即可,我定义的是 ~/cert/HaC.keystore")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-8-8-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /var/www/web/jdk/jdk1.8.0_261/bin/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-8-8-centos bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir ~/cert")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-8-8-centos bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# keytool -genkey -v -alias testKey -keyalg RSA -validity 3650 -keystore ~/cert/HaC.keystore")]),t._v("\nEnter keystore password:\nRe-enter new password:\nWhat is your first and last name?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  HaC\nWhat is the name of your organizational unit?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  baimuTel\nWhat is the name of your organization?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  yudianxx\nWhat is the name of your City or Locality?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  guangzhou\nWhat is the name of your State or Province?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  guangdong\nWhat is the two-letter country code "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" this unit?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unknown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),t._v("\nIs "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("HaC, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OU")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("baimuTel, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("O")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yudianxx, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("L")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("guangzhou, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("guangdong, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("C")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),t._v(" correct?\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("no"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  y\n\nGenerating "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2,048")]),t._v(" bit RSA key pair and self-signed certificate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SHA256withRSA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" with a validity of "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3,650")]),t._v(" days\n        for: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("HaC, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OU")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("baimuTel, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("O")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yudianxx, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("L")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("guangzhou, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("guangdong, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("C")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("86")]),t._v("\nEnter key password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("testKey"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RETURN "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" same as keystore password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":\nRe-enter new password:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Storing /root/cert/HaC.keystore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nWarning:\nThe JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" is an industry standard "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("format")]),t._v(" using "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"keytool -importkeystore -srckeystore /root/cert/HaC.keystore -destkeystore /root/cert/HaC.keystore -deststoretype pkcs12"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("信息可以随便填，但是密码要记得，下面要用到。")]),t._v(" "),a("h5",{attrs:{id:"_1-2、-tomcat配置https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、-tomcat配置https"}},[t._v("#")]),t._v(" 1.2、 tomcat配置https")]),t._v(" "),a("p",[t._v("tomcat的conf目录下,打开server.xml文件")]),t._v(" "),a("p",[t._v("修改，加入刚才生成的证书路径，keystoreFile 你的keystore路径，keystorePass 是刚才生成时输入的密码。把Tomcat的默认的"),a("code",[t._v("https://")]),t._v("端口8443修改为443，不然你只能通过 "),a("code",[t._v("https://www.baimuxym.cn:8443")]),t._v(" 访问了")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.coyote.http11.Http11NioProtocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n               "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("maxThreads")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("150"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("SSLEnabled")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("scheme")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("secure")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n               "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("clientAuth")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("sslProtocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("TLS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keystoreFile")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/root/cert/HaC.keystore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keystorePass")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("123456"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("h5",{attrs:{id:"_1-3、-设置http自动跳转到https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、-设置http自动跳转到https"}},[t._v("#")]),t._v(" 1.3、 设置http自动跳转到https")]),t._v(" "),a("p",[t._v("把http的请求都转发到https")]),t._v(" "),a("p",[t._v("找到tomcat目录下的conf/web.xml文件，末尾 加入：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ====================自动跳转——start ===================== --\x3e")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("security-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("web-resource-collection")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("web-resource-name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("SSL"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("web-resource-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url-pattern")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/*"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url-pattern")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("web-resource-collection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("                             \n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("user-data-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("transport-guarantee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("CONFIDENTIAL"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("transport-guarantee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("user-data-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("security-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ====================自动跳转——end ===================== --\x3e")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file-list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.html"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.htm"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.jsp"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file-list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("重启tomcat，访问我的域名。 "),a("a",{attrs:{href:"https://www.baimuxym.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.baimuxym.cn"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20201012095954123.png",alt:""}})]),t._v(" "),a("p",[t._v("发现是提示证书存在安全问题 的，点击继续浏览 但是仍然 可以访问。")]),t._v(" "),a("p",[t._v("导出证书：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-8-8-centos apache-tomcat-8.0.53"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# keytool -exportcert -rfc -alias HaC -file  ~/cert/HaC.cer -keystore  ~/cert/HaC.keystore -storepass 123456      ")]),t._v("\n\nCertificate stored "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/root/cert/HaC.cer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("给浏览器安装证书：")]),t._v(" "),a("blockquote",[a("p",[t._v("在ie浏览器下，进入“Internet选项”-“内容”-“证书”-在“受信任的根证书颁发机构”中导入tomcat.cer文件。")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/clipboard-1602490357282.png",alt:""}})]),t._v(" "),a("p",[t._v("浏览器 一样提示 "),a("strong",[t._v("不安全的连接")]),t._v("。")]),t._v(" "),a("p",[t._v("没办法了，浏览器也无法信任自定义的证书。")]),t._v(" "),a("blockquote",[a("p",[t._v("我看到网上也有人 添加了受信任的证书后就提示安全了，我这里试了确实不行，希望有小伙伴告诉我到底可不可以。")]),t._v(" "),a("p",[t._v("可能是以前可以，现在不行了？")])]),t._v(" "),a("h4",{attrs:{id:"_2、公开可信认证机构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、公开可信认证机构"}},[t._v("#")]),t._v(" 2、公开可信认证机构")]),t._v(" "),a("p",[t._v("keyken生成的不行，那就用商用的。")]),t._v(" "),a("p",[t._v("但商用的SSL实在是太贵了，比如说赛门铁克、亚信，个人一般都难以承受；")]),t._v(" "),a("p",[a("strong",[t._v("let's encrypt")]),t._v(" 是一个免费的SSL组织，申请后有3个月的期限，到期可以续杯。")]),t._v(" "),a("p",[t._v("云厂商也可以申请证书，只要你购买了它们的域名。")]),t._v(" "),a("h5",{attrs:{id:"_2-1、申请证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、申请证书"}},[t._v("#")]),t._v(" 2.1、申请证书")]),t._v(" "),a("p",[t._v("腾讯云 可以免费申请 1年的免费证书（"),a("strong",[t._v("到期可以继续 续")]),t._v("），我这里使用腾讯云为例子：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/clipboard-1602490419094.png",alt:""}})]),t._v(" "),a("p",[t._v("申请完毕，点击下载 ， 解压看到这个压缩包有几种服务器的不同类型证书。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/clipboard-1602490530864.png",alt:"img"}})]),t._v(" "),a("p",[t._v("我们是Tomcat的服务器，就把Tomcat的"),a("code",[t._v(".jks")]),t._v("文件证书上传到服务器。")]),t._v(" "),a("h5",{attrs:{id:"_2-2、tomcat配置https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、tomcat配置https"}},[t._v("#")]),t._v(" 2.2、tomcat配置https")]),t._v(" "),a("p",[t._v("替换server.xml的jks证书路径和密码即可：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.coyote.http11.Http11NioProtocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\n               "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("maxThreads")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("150"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("SSLEnabled")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("scheme")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("secure")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n\n               "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("clientAuth")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("sslProtocol")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("TLS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keystoreFile")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/root/cert/www.baimuxym.cn.jks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keystorePass")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("i24vj6841f1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("h5",{attrs:{id:"_2-3、设置http自动跳转到https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、设置http自动跳转到https"}},[t._v("#")]),t._v(" 2.3、设置http自动跳转到https")]),t._v(" "),a("p",[t._v("把http的请求都转发到https：")]),t._v(" "),a("p",[t._v("找到tomcat目录下的conf/web.xml文件，末尾 加入：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ====================自动跳转——start ===================== --\x3e")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("security-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("web-resource-collection")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("web-resource-name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("SSL"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("web-resource-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("url-pattern")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/*"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("url-pattern")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("web-resource-collection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("                             \n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("user-data-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("transport-guarantee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("CONFIDENTIAL"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("transport-guarantee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("user-data-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("security-constraint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ====================自动跳转——end ===================== --\x3e")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file-list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.html"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.htm"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("index.jsp"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("welcome-file-list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("然后重启Tomcat。访问  "),a("a",{attrs:{href:"https://www.baimuxym.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.baimuxym.cn"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("如果不生效，可以更换浏览器访问试试")])]),t._v(" "),a("p",[t._v("现在就不会提示证书不安全了。完美！")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/DogerRain/image@main/img-20210401/image-20201011214916243-1602490397611.png",alt:""}})]),t._v(" "),a("p",[t._v("到这里，一个项目就已经部署完成了，但只是一个静态网页。")]),t._v(" "),a("p",[t._v("部署JavaWeb项目，也是一样的操作，只不过要结合Redis、MySQL等等。")]),t._v(" "),a("p",[t._v("体验地址：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.baimuxym.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.baimuxym.cn"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://rain.baimuxym.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://rain.baimuxym.cn"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);