(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{410:function(t,e,a){t.exports=a.p+"assets/img/d18a0b5973734be98e5863e4095a6619.b83f88bb.png"},761:function(t,e,a){"use strict";a.r(e);var s=a(7),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("开源监控系统有很多，但是一般来说，国内流行的就两种：")]),t._v(" "),e("ul",[e("li",[t._v("zabbix")]),t._v(" "),e("li",[t._v("prometheus")])]),t._v(" "),e("p",[t._v("这两者的监控范围都是围绕 "),e("strong",[t._v("指标")]),t._v(" 做监控（现在prometheus也有关于日志、链路的方案，但是没什么人用）")]),t._v(" "),e("h2",{attrs:{id:"_1、zabbix"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、zabbix"}},[t._v("#")]),t._v(" 1、Zabbix")]),t._v(" "),e("p",[t._v("一个大而全的 monolithic 应用，集成了数据采集、存储、告警、可视化于一身。对传统IT设施（网络设备、VM、数据库）的监控支持非常好。")]),t._v(" "),e("p",[t._v("zabbix 应该很多开发者都会听说过。")]),t._v(" "),e("p",[t._v("注意我说的是 传统IT设施。类似于服务器的CPU、内存、磁盘 等等。")]),t._v(" "),e("p",[t._v("它也可以监控服务，例如Java（通过Java程序开启JMX，监控JVM如堆内存、GC 等等）")]),t._v(" "),e("p",[e("img",{attrs:{src:a(410),alt:"在这里插入图片描述"}})]),t._v(" "),e("p",[t._v("不过在我看来，Zabbix 不如 Prometheus ，Prometheus 包含了所有 Zabbix 的功能，同时它更简单、功能更强大。")]),t._v(" "),e("h2",{attrs:{id:"_2、prometheus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、prometheus"}},[t._v("#")]),t._v(" 2、Prometheus")]),t._v(" "),e("p",[t._v("微服务以及云原生的趋势下，"),e("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("prometheus"),e("OutboundLink")],1),t._v(" 应运而生。")]),t._v(" "),e("p",[t._v("Prometheus 专为云原生世界而设计，可与 Kubernetes 以及其他云和容器管理器集成，持续发现和监服务。")]),t._v(" "),e("p",[t._v("Prometheus是一个开源系统监控和警报工具包，它太丰富了，既可以收集、存储、查询 指标，又可以做告警、仪表板。")]),t._v(" "),e("blockquote",[e("p",[t._v("Prometheus 的查询语言十分强大，但是其数据格式还是 Prometheus 自己定义的。因此，它只能与 Prometheus 服务器集成，不能与其他系统集成。")])]),t._v(" "),e("p",[e("img",{attrs:{src:"picture/image-20240211211731954.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"prometheus-指标类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-指标类型"}},[t._v("#")]),t._v(" Prometheus 指标类型")]),t._v(" "),e("p",[t._v("Prometheus 定义了 4 种不同的指标类型：")]),t._v(" "),e("ul",[e("li",[t._v("Counter（计数器）")]),t._v(" "),e("li",[t._v("Gauge（仪表盘）")]),t._v(" "),e("li",[t._v("Histogram（直方图）")]),t._v(" "),e("li",[t._v("Summary（汇总）")])]),t._v(" "),e("h3",{attrs:{id:"prometheus-文本格式-协议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-文本格式-协议"}},[t._v("#")]),t._v(" prometheus 文本格式（协议）")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HELP http_requests_total The total number of HTTP requests.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TYPE http_requests_total counter")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_requests_total{method")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"post",code="200"} 1027 1395066363000')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_requests_total{method")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"post",code="400"}    3 1395066363000')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Minimalistic line:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("metric_without_timestamp_and_labels")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("12.47")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A weird metric from before the epoch:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("something_weird{problem")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"division by zero"} +Inf -3982045')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A histogram, which has a pretty complex representation in the text format:")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HELP http_request_duration_seconds A histogram of the request duration.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TYPE http_request_duration_seconds histogram")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_bucket{le")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"0.05"} 24054')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_bucket{le")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"0.1"} 33444')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_bucket{le")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"0.2"} 100392')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_bucket{le")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"0.5"} 129389')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_bucket{le")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"1"} 133988')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_bucket{le")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"+Inf"} 144320')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_sum")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("53423")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("http_request_duration_seconds_count{app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"demo"} 144320')]),t._v("\n\n")])])]),e("blockquote",[e("p",[t._v('http_request_duration_seconds_count{app="demo"} 144320  为例：')]),t._v(" "),e("p",[t._v("http_request_duration_seconds_count  -- 指标名称")]),t._v(" "),e("p",[t._v('{app="demo"} -- 标签，k=v形式，用于丰富指标的描述')]),t._v(" "),e("p",[t._v("144320  值")]),t._v(" "),e("p",[t._v("合起来的含义就是： http 请求次数，从程序运行以来累计记录值就是 144320  次")])]),t._v(" "),e("p",[t._v("这些简单的数据类型，使用PromQL（一种 利用此维度的灵活查询语言 ）对开发人员来说，十分简单。")]),t._v(" "),e("p",[t._v("同时还有开源 exporter 的配合（暴露prometheus格式指标） + grafana（展示）， 可以做成更多自定义图表：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://grafana.com/media/products/cloud/grafana/grafana-dashboard-english.png",alt:"img"}})]),t._v(" "),e("p",[t._v("在可观测建设能力的上来说，选择 prometheus ，可以说是最快速，最简单的方案了。")])])}),[],!1,null,null,null);e.default=r.exports}}]);